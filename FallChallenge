#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <stdbool.h>

/**
 * Auto-generated code below aims at helping you parse
 * the standard input according to the problem statement.
 **/


/*void    ft_strcpy(char **dst, char *src)
{
    int i = 0;

    while (src[i])
    {
        (*dst)[i] = src[i];
        i++;
    }
    (*dst)[i] = '\0';
}*/
typedef struct building_type
{
    int    type;
    int    id;
    int    x;
    int    y;
    int    n_astronauts;
    int    astronauts[20];
    int    types_astr;
    int    tube;
}   building_struct;

building_struct **buildings;
int             b_counter = 0;
int             n_pod = 0;
int             t_counter = 0;

int ctoi(char   c)
{
    return (c - 48);
}

int match_types(int in, int *d)
{
    while (*d < 20)
    {
        if (buildings[in]->astronauts[*d])
        {
            for (int j = 0; j < b_counter; j++)
            {
                if (buildings[j]->type == *d + 1)
                {
                    (*d)++;
                    return (j);
                }
            }
        }
        (*d)++;
    }
    return (0);
}

int parse_properties(char *building_properties, int *in)
{
    int r = 0;

    while (building_properties[*in] >= '0' && building_properties[*in] <= '9')
    {
        r *= 10;
        r += ctoi(building_properties[*in]);
        (*in)++;
    }
    (*in)++;
    return (r);
}

void    add_building(char *building_properties)
{
    int in = 0;

    buildings[b_counter] = malloc(sizeof(building_struct));
    buildings[b_counter]->type = parse_properties(building_properties, &in);
    buildings[b_counter]->id = parse_properties(building_properties, &in);
    buildings[b_counter]->x = parse_properties(building_properties, &in);
    buildings[b_counter]->y = parse_properties(building_properties, &in);
    if (buildings[b_counter]->type == 0)
    {
        buildings[b_counter]->n_astronauts = parse_properties(building_properties, &in);
        for (int i = 0; i < 20; i++)
            buildings[b_counter]->astronauts[i] = 0;
        int j = buildings[b_counter]->n_astronauts;
        while (j > 0)
        {
            int type_astronaut = parse_properties(building_properties, &in);
            buildings[b_counter]->astronauts[type_astronaut - 1]++;
            j--;
        }
        for (int i = 0; i < 20; i++)
        {
            if(buildings[b_counter]->astronauts[i])
                buildings[b_counter]->types_astr++;
        }
    }
    else
        buildings[b_counter]->n_astronauts = 0;
    buildings[b_counter]->tube = 0;
    b_counter++;
}

/*void    build_tubes()
{
    if (!buildings[t_counter]->tube)
    {
        int dst_route = t_counter + 1;
        if (dst_route >= b_counter)
            dst_route = 0;
        printf("TUBE %i %i; POD %i %i %i;\n", t_counter, dst_route, n_pod, t_counter, dst_route);
        n_pod++;
        buildings[t_counter]->tube = 1;
        t_counter++;
    }
}*/

int main()
{
    buildings = malloc(3 * sizeof(building_struct*));
    // game loop
    while (1) 
    {
        int resources;
        scanf("%d", &resources);
        fprintf(stderr, "Llega");

        int num_travel_routes;
        scanf("%d", &num_travel_routes); fgetc(stdin);
        for (int i = 0; i < num_travel_routes; i++) 
        {
            int building_id_1;
            int building_id_2;
            int capacity;
            scanf("%d%d%d", &building_id_1, &building_id_2, &capacity);
        }

        int num_pods;
        scanf("%d", &num_pods); fgetc(stdin);
        for (int i = 0; i < num_pods; i++) 
        {
            char pod_properties[201];
            scanf("%[^\n]", pod_properties); fgetc(stdin);
        }

        int num_new_buildings;
        scanf("%d", &num_new_buildings); fgetc(stdin);
        for (int i = 0; i < num_new_buildings; i++) 
        {
            char building_properties[501];
            scanf("%[^\n]", building_properties); fgetc(stdin);
            add_building(building_properties);
        }

        for (int i = 0; i < b_counter; i++)
        {
            if (buildings[i]->type == 0)
            {
                int j = buildings[i]->types_astr;
                int d = 0;
                match_types(i, &d);
                while (j > 0 && d <= 19)
                {
                    printf("TUBE %i %i;\n", i, d);
                    match_types(i, &d);
                }
            }
        }
        //No parece muy óptimo, pero parece que hemos conseguido que construya tuberías, \
            correctamente, de manera automatizada(terminar de comprobar). Ahora habría que \
            llenar de POD's.

        /*if (t_counter < b_counter)
            build_tubes();
        int c = 0;
        while (c < b_counter)
        {
            int d = match_types(c);
            if (d)
            {
                printf("TUBE %i %i;\n",c, d);
                continue ;
            }
            c++;
        }*/
        /*if (num_new_buildings)
        {
            if (buildi)
        }
            printf("TUBE 0 3;POD 2 0 3 0 3\n");*/

        //printf("TUBE 0 1; POD 0 0 1 0 1 0 1; TUBE 0 2; POD 1 0 2 0 2 0 2;\n");

        // Write an action using printf(). DON'T FORGET THE TRAILING \n
        // To debug: fprintf(stderr, "Debug messages...\n");

        // TUBE | UPGRADE | TELEPORT | POD | DESTROY | WAIT
    }

    return 0;
}